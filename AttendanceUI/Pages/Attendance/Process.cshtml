@page
@model AttendanceUI.Pages.Attendance.ProcessModel
@{
    ViewData["Title"] = "Process Attendance";
}

<h1 class="h3 mb-3">Process Attendance</h1>

@if (!string.IsNullOrEmpty(Model.Message))
{
    var alertClass = Model.Message.StartsWith("Error:") ? "alert-danger" : "alert-success";
    <div class="alert @alertClass alert-dismissible fade show" role="alert">
        @Model.Message.Replace("Error: ", "").Replace("Success: ", "")
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

<div class="card">
    <div class="card-header">
        Process Daily Attendance Logic
    </div>
    <div class="card-body">
        <p class="card-text text-muted">
            This action will calculate attendance status (Present, Absent, Late, Early, Single Punch) based on raw logs and shift rules.
            <br />
            <strong>Note:</strong> Manual overrides will effectively lock a record from being re-processed.
        </p>

        <form method="post" class="row g-3 align-items-end">
            <div class="col-md-3">
                <label asp-for="FromDate" class="form-label">From Date</label>
                <input asp-for="FromDate" class="form-control" type="date" />
            </div>
            <div class="col-md-3">
                <label asp-for="ToDate" class="form-label">To Date</label>
                <input asp-for="ToDate" class="form-control" type="date" />
            </div>
            <div class="col-md-3">
                <div class="form-check mt-4">
                    <input asp-for="ClearFutureData" class="form-check-input" type="checkbox" />
                    <label asp-for="ClearFutureData" class="form-check-label">
                        Clear future data
                    </label>
                </div>
                <small class="text-muted">Delete all attendance after "To Date"</small>
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-primary w-100">
                    <i class="bi bi-gear-fill"></i> Process
                </button>
            </div>
        </form>
    </div>
</div>
